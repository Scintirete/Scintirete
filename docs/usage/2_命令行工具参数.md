# Scintirete CLI 命令文档

本文档介绍了重构后的 Scintirete CLI 命令结构。命令现在采用更加层次化的子命令形式组织。

## 基本命令

### 连接和系统命令
- `ping` - 测试与服务器的连接
- `version` - 显示版本信息
- `help [command]` - 显示帮助信息
- `quit` / `exit` - 退出CLI
- `use <database>` - 切换到指定数据库

### 持久化命令
- `save` - 同步保存RDB快照
- `bgsave` - 异步保存RDB快照

## 子命令系统

### 数据库操作 (`database`)

```bash
database list                    # 列出所有数据库
database create <name>           # 创建新数据库
database drop <name>             # 删除数据库
```

**示例：**
```bash
database list
database create mydb
database drop olddb
```

### 集合操作 (`collection`)

> 注意：需要先使用 `use <database>` 选择数据库

```bash
collection list                                           # 列出当前数据库中的所有集合
collection create <name> <metric> [m] [ef_construction]  # 创建新集合
collection drop <name>                                   # 删除集合
collection info <name>                                   # 获取集合信息
```

**支持的距离度量：**
- `L2` / `EUCLIDEAN` - 欧几里得距离
- `COSINE` - 余弦距离
- `INNER_PRODUCT` / `IP` - 内积

**HNSW参数：**
- `m` - 每个节点的最大连接数（默认16）
- `ef_construction` - 构建时的搜索宽度（默认200）

**示例：**
```bash
collection list
collection create vectors L2 16 200
collection create embeddings COSINE
collection info vectors
collection drop oldcollection
```

### 向量操作 (`vector`)

> 注意：需要先使用 `use <database>` 选择数据库

```bash
vector insert <collection> <id> <vector> [metadata]     # 插入向量
vector search <collection> <vector> [top-k] [ef-search] # 搜索相似向量
vector delete <collection> <id1> [id2] ...              # 删除向量
```

**向量格式：** JSON数组，例如 `[1.0, 2.0, 3.0]`

**示例：**
```bash
vector insert vectors vec1 "[1.0, 2.0, 3.0, 4.0]"
vector search vectors "[1.1, 2.1, 3.1, 4.1]" 10
vector delete vectors vec1 vec2
```

### 文本嵌入操作 (`text`)

> 注意：需要先使用 `use <database>` 选择数据库

```bash
text insert <collection> <id> <text> [metadata] [model] # 插入文本（自动嵌入）
text search <collection> <text> [top-k] [ef-search] [model] # 搜索文本（自动嵌入）
```

**示例：**
```bash
text insert documents doc1 "这是一段示例文本"
text search documents "示例" 5
text insert documents doc2 "Another example" '{"category": "test"}'
```

## 命令行选项

启动CLI时可以使用以下选项：

```bash
scintirete-cli [options] [command]
```

**选项：**
- `-h <host>` - 服务器主机（默认：localhost）
- `-p <port>` - 服务器端口（默认：9090）
- `-a <password>` - 认证密码
- `-d <database>` - 默认使用的数据库
- `--help` - 显示帮助信息

**示例：**
```bash
# 连接到远程服务器
scintirete-cli -h 192.168.1.100 -p 9090 -a mypassword

# 直接执行命令
scintirete-cli -d mydb collection list

# 交互模式
scintirete-cli -h localhost -p 9090
```

## 交互模式

不带参数启动CLI会进入交互模式：

```bash
$ scintirete-cli
Scintirete CLI v1.0.0 (commit: abc123)
Type 'help' for available commands or 'quit' to exit.

scintirete> use mydb
Switched to database 'mydb'.
scintirete[mydb]> collection list
Collections:
1) vectors (dimension: 4, vectors: 100, metric: L2)
2) embeddings (dimension: 768, vectors: 50, metric: COSINE)
scintirete[mydb]> vector search vectors "[1.0, 2.0, 3.0, 4.0]" 5
Search completed in 2.35ms, found 5 results:
...
```

## 命令迁移指南

如果您之前使用旧的命令格式，以下是迁移对照表：

| 旧命令 | 新命令 |
|--------|--------|
| `list-databases` | `database list` |
| `create-database <name>` | `database create <name>` |
| `drop-database <name>` | `database drop <name>` |
| `list-collections` | `collection list` |
| `create-collection <name> <metric>` | `collection create <name> <metric>` |
| `drop-collection <name>` | `collection drop <name>` |
| `collection-info <name>` | `collection info <name>` |
| `insert <collection> <id> <vector>` | `vector insert <collection> <id> <vector>` |
| `search <collection> <vector>` | `vector search <collection> <vector>` |
| `delete <collection> <id>` | `vector delete <collection> <id>` |

新的子命令结构提供了更好的组织性和一致性，使得相关操作被逻辑性地分组在一起。 